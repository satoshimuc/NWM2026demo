<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NAGOYA WOMEN'S MARATHON 2026</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- LINE LIFF SDK (å¿…é ˆè¦ä»¶1) -->
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

    <style>
        /* Custom Scrollbar Styles */
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #ddd; border-radius: 4px; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // --- å†…è”µã‚¢ã‚¤ã‚³ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¾å­˜ã‚’æ’é™¤) ---
        // Lucide Iconsã®ãƒ‡ã‚¶ã‚¤ãƒ³ã«åŸºã¥ã„ãŸSVGå®šç¾©
        const IconBase = ({ children, size = 24, className = "" }) => (
          <svg 
            xmlns="http://www.w3.org/2000/svg" 
            width={size} 
            height={size} 
            viewBox="0 0 24 24" 
            fill="none" 
            stroke="currentColor" 
            strokeWidth="2" 
            strokeLinecap="round" 
            strokeLinejoin="round" 
            className={className}
          >
            {children}
          </svg>
        );

        const Menu = (props) => <IconBase {...props}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></IconBase>;
        const X = (props) => <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>;
        const MapPin = (props) => <IconBase {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></IconBase>;
        const Award = (props) => <IconBase {...props}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></IconBase>;
        const Lightbulb = (props) => <IconBase {...props}><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .5 2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></IconBase>;
        const ShoppingBag = (props) => <IconBase {...props}><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></IconBase>;
        const ChevronRight = (props) => <IconBase {...props}><path d="m9 18 6-6-6-6"/></IconBase>;
        const Calendar = (props) => <IconBase {...props}><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/></IconBase>;
        const Camera = (props) => <IconBase {...props}><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></IconBase>;
        const Heart = (props) => <IconBase {...props}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></IconBase>;
        const Share2 = (props) => <IconBase {...props}><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/></IconBase>;
        const User = (props) => <IconBase {...props}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconBase>;
        const Users = (props) => <IconBase {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconBase>;
        const PlayCircle = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></IconBase>;
        const CheckCircle = (props) => <IconBase {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconBase>;
        const Smartphone = (props) => <IconBase {...props}><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></IconBase>;
        const ArrowRight = (props) => <IconBase {...props}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></IconBase>;
        const Info = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></IconBase>;
        const Home = (props) => <IconBase {...props}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></IconBase>;
        const ArrowLeft = (props) => <IconBase {...props}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></IconBase>;
        const Clock = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></IconBase>;

        /**
         * MOCK DATA & ASSETS
         */
        const NEWS_ITEMS = [
          { id: 1, date: '2024.11.25', tag: 'NEW', title: 'å¤§ä¼šé™å®šTã‚·ãƒ£ãƒ„äºˆç´„é–‹å§‹ï¼', color: 'bg-pink-500' },
          { id: 2, date: '2024.11.20', tag: 'ãŠçŸ¥ã‚‰ã›', title: 'è©¦èµ°ä¼šã‚¨ãƒ³ãƒˆãƒªãƒ¼å—ä»˜ä¸­', color: 'bg-purple-500' },
          { id: 3, date: '2024.11.15', tag: 'ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³', title: 'EXPOå…ˆè¡Œå…¥å ´åˆ¸ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ', color: 'bg-blue-500' },
        ];

        const SHOES_DATA = [
          { id: 1, name: 'FuelCell Rebel v5', price: '11,880å††', img: 'shoe1', desc: 'ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚’æ±‚ã‚ã‚‹ãƒ©ãƒ³ãƒŠãƒ¼ã¸' },
          { id: 2, name: 'Fresh Foam X 1080', price: '18,700å††', img: 'shoe2', desc: 'ç©¶æ¥µã®ã‚¯ãƒƒã‚·ãƒ§ãƒ³æ€§' },
          { id: 3, name: 'FuelCell SuperComp', price: '24,200å††', img: 'shoe3', desc: 'è‡ªå·±ãƒ™ã‚¹ãƒˆæ›´æ–°ã‚’ç›®æŒ‡ã™' },
          { id: 4, name: 'Fresh Foam X 860', price: '16,500å††', img: 'shoe4', desc: 'å®‰å®šæ€§ã¨ã‚µãƒãƒ¼ãƒˆ' },
        ];

        const COURSE_SPOTS = [
          { id: 1, name: 'ãƒŠã‚´ãƒ¤ãƒ‰ãƒ¼ãƒ  (START)', desc: 'ç†±æ°—ã‚ãµã‚Œã‚‹ã‚¹ã‚¿ãƒ¼ãƒˆåœ°ç‚¹ã€‚', img: 'ğŸŸï¸' },
          { id: 2, name: 'åå¤å±‹åŸ', desc: 'é‡‘ã‚·ãƒ£ãƒãŒè¦‹å®ˆã‚‹çµ¶æ™¯ã‚¹ãƒãƒƒãƒˆã€‚', img: 'ğŸ¯' },
          { id: 3, name: 'æ „äº¤å·®ç‚¹', desc: 'åå¤å±‹ã®ä¸­å¿ƒåœ°ã‚’é§†ã‘æŠœã‘ã‚‹ã€‚', img: 'ğŸ™ï¸' },
          { id: 4, name: 'å¤§é ˆè¦³éŸ³', desc: 'ä¸‹ç”ºã®æ´»æ°—ã‚’æ„Ÿã˜ã‚‹ã‚¨ãƒªã‚¢ã€‚', img: 'ğŸ®' },
          { id: 5, name: 'ãƒŠã‚´ãƒ¤ãƒ‰ãƒ¼ãƒ  (GOAL)', desc: 'ãƒ†ã‚£ãƒ•ã‚¡ãƒ‹ãƒ¼ãŒå¾…ã¤æ„Ÿå‹•ã®ã‚´ãƒ¼ãƒ«ã€‚', img: 'ğŸ' },
        ];

        const ADVICE_CONTENT = {
          weekBefore: { title: '1é€±é–“å‰', text: 'ã‚«ãƒ¼ãƒœãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚ç¡çœ æ™‚é–“ã‚’ç¢ºä¿ã—ã€ä½“èª¿ã‚’æ•´ãˆã‚‹ã“ã¨ãŒæœ€å„ªå…ˆã§ã™ã€‚' },
          dayBefore: { title: 'å‰æ—¥', text: 'é£Ÿäº‹ã¯æ¶ˆåŒ–ã®è‰¯ã„ã‚‚ã®ã‚’ã€‚æº–å‚™ç‰©ã¯æ—©ã‚ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ã€ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¦éã”ã—ã¾ã—ã‚‡ã†ã€‚' },
          morning: { title: 'å½“æ—¥æœ', text: 'ã‚¹ã‚¿ãƒ¼ãƒˆ3æ™‚é–“å‰ã«ã¯èµ·åºŠã€‚æœé£Ÿã¯ãŠé¤…ã‚„ãƒãƒŠãƒŠãªã©ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«ãªã‚‹ã‚‚ã®ã‚’æ‘‚å–ã—ã¾ã—ã‚‡ã†ã€‚' },
          after: { title: 'ãƒ¬ãƒ¼ã‚¹å¾Œ', text: 'ã¾ãšã¯æ°´åˆ†è£œçµ¦ã¨ã‚¢ã‚¤ã‚·ãƒ³ã‚°ã€‚é ‘å¼µã£ãŸè‡ªåˆ†ã‚’è¤’ã‚ã¦ã€ã‚†ã£ãã‚ŠãŠé¢¨å‘‚ã«å…¥ã‚Šã¾ã—ã‚‡ã†ã€‚' },
        };

        /**
         * COMPONENTS
         */

        // UI Components
        const Card = ({ children, className = "" }) => (
          <div className={`bg-white rounded-2xl shadow-sm overflow-hidden ${className}`}>
            {children}
          </div>
        );

        const SectionTitle = ({ icon: Icon, title, color = "text-gray-800" }) => (
          <h2 className={`text-lg font-bold flex items-center gap-2 mb-3 ${color}`}>
            {Icon && <Icon size={20} className="text-pink-500" />}
            {title}
          </h2>
        );

        const Badge = ({ children, color = "bg-gray-200 text-gray-700" }) => (
          <span className={`text-xs px-2 py-0.5 rounded-full font-bold ${color}`}>
            {children}
          </span>
        );

        // --- Sub-Pages ---

        // 1. Stamp Rally View
        const StampRallyView = ({ onBack, progress, setProgress }) => {
          const tasks = [
            { id: 'quiz', title: 'ãƒ‹ãƒ¥ãƒ¼ãƒãƒ©ãƒ³ã‚¹æ¤œå®š', icon: Lightbulb, sub: 'å…¨3å•ã®ã‚¯ã‚¤ã‚ºã«æŒ‘æˆ¦' },
            { id: 'tryon', title: 'è©¦ã—å±¥ãã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ', icon: ShoppingBag, sub: 'ã´ã£ãŸã‚Šã®ä¸€è¶³ã‚’è¦‹ã¤ã‘ã‚‹' },
            { id: 'video', title: 'SPå‹•ç”»ã‚’è¦–è´', icon: PlayCircle, sub: 'ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³UP' },
          ];

          const handleTaskClick = (id) => {
            if (!progress.includes(id)) {
              setProgress([...progress, id]);
              try {
                  if (window.navigator && window.navigator.vibrate) { window.navigator.vibrate(200); }
              } catch(e){}
            }
          };

          return (
            <div className="p-4 space-y-6 pb-24 animate-fade-in">
              <div className="flex items-center gap-2 mb-4">
                <button onClick={onBack} className="p-2 bg-gray-100 rounded-full"><ArrowLeft size={20}/></button>
                <h2 className="text-xl font-bold text-gray-800">ã‚¹ã‚¿ãƒ³ãƒ—ãƒ©ãƒªãƒ¼</h2>
              </div>

              <Card className="p-6 bg-gradient-to-br from-purple-500 to-pink-500 text-white text-center">
                <h3 className="text-lg font-bold mb-2">ç¾åœ¨ã®ç²å¾—ã‚¹ã‚¿ãƒ³ãƒ—</h3>
                <div className="flex justify-center gap-4 my-4">
                  {tasks.map((task) => (
                    <div key={task.id} className={`w-16 h-16 rounded-full flex items-center justify-center border-4 ${progress.includes(task.id) ? 'bg-white text-pink-500 border-white' : 'bg-transparent border-white/30 text-white/30'}`}>
                      <Award size={32} />
                    </div>
                  ))}
                </div>
                <p className="text-sm opacity-90">{progress.length} / 3 ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆ</p>
                {progress.length === 3 && (
                  <div className="mt-4 bg-yellow-400 text-yellow-900 py-2 px-4 rounded-full font-bold animate-bounce">
                    ğŸ‰ ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆç‰¹å…¸GET!
                  </div>
                )}
              </Card>

              <div className="space-y-4">
                {tasks.map((task) => (
                  <button 
                    key={task.id}
                    onClick={() => handleTaskClick(task.id)}
                    className="w-full bg-white p-4 rounded-xl shadow-sm flex items-center justify-between group active:scale-95 transition-transform"
                  >
                    <div className="flex items-center gap-4">
                      <div className={`p-3 rounded-full ${progress.includes(task.id) ? 'bg-green-100 text-green-600' : 'bg-gray-100 text-gray-400'}`}>
                        {progress.includes(task.id) ? <CheckCircle size={24} /> : <task.icon size={24} />}
                      </div>
                      <div className="text-left">
                        <h4 className="font-bold text-gray-800">{task.title}</h4>
                        <p className="text-xs text-gray-500">{task.sub}</p>
                      </div>
                    </div>
                    <ChevronRight className="text-gray-300" />
                  </button>
                ))}
              </div>
            </div>
          );
        };

        // 2. Course Guide View
        const CourseView = ({ onBack }) => {
          return (
            <div className="p-4 space-y-6 pb-24 animate-fade-in">
              <div className="flex items-center gap-2 mb-4">
                <button onClick={onBack} className="p-2 bg-gray-100 rounded-full"><ArrowLeft size={20}/></button>
                <h2 className="text-xl font-bold text-gray-800">ã‚³ãƒ¼ã‚¹è§£èª¬</h2>
              </div>
              
              <div className="relative h-48 bg-gray-200 rounded-2xl overflow-hidden mb-6 flex items-center justify-center">
                <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent z-10"></div>
                <span className="text-6xl z-0 opacity-20">ğŸ—ºï¸</span>
                <p className="absolute bottom-4 left-4 text-white font-bold z-20 text-lg">Nagoya Women's 2026 Map</p>
              </div>

              <div className="space-y-4 relative">
                <div className="absolute left-4 top-4 bottom-4 w-0.5 bg-pink-200"></div>
                {COURSE_SPOTS.map((spot, idx) => (
                  <div key={spot.id} className="relative pl-10">
                    <div className="absolute left-2 top-3 w-4 h-4 rounded-full bg-pink-500 border-2 border-white shadow-sm z-10"></div>
                    <Card className="p-4 flex gap-4">
                      <div className="w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center text-3xl flex-shrink-0">
                        {spot.img}
                      </div>
                      <div>
                        <span className="text-xs font-bold text-pink-500">SPOT {idx + 1}</span>
                        <h4 className="font-bold text-gray-800">{spot.name}</h4>
                        <p className="text-sm text-gray-600 mt-1">{spot.desc}</p>
                      </div>
                    </Card>
                  </div>
                ))}
              </div>
            </div>
          );
        };

        // 3. Advice View
        const AdviceView = ({ onBack }) => {
          const [activeTab, setActiveTab] = useState('weekBefore');
          const tabs = [
            { id: 'weekBefore', label: '1é€±é–“å‰' },
            { id: 'dayBefore', label: 'å‰æ—¥' },
            { id: 'morning', label: 'å½“æ—¥æœ' },
            { id: 'after', label: 'ãƒ¬ãƒ¼ã‚¹å¾Œ' },
          ];

          return (
            <div className="p-4 pb-24 h-full flex flex-col animate-fade-in">
              <div className="flex items-center gap-2 mb-4">
                <button onClick={onBack} className="p-2 bg-gray-100 rounded-full"><ArrowLeft size={20}/></button>
                <h2 className="text-xl font-bold text-gray-800">ã‚¢ãƒ³ãƒã‚µãƒ€ãƒ¼ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h2>
              </div>

              <div className="flex gap-2 overflow-x-auto pb-2 mb-4 scrollbar-hide">
                {tabs.map(tab => (
                  <button
                    key={tab.id}
                    onClick={() => setActiveTab(tab.id)}
                    className={`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition-colors ${
                      activeTab === tab.id 
                        ? 'bg-pink-500 text-white shadow-md' 
                        : 'bg-white text-gray-500 border border-gray-100'
                    }`}
                  >
                    {tab.label}
                  </button>
                ))}
              </div>

              <Card className="p-6 flex-grow bg-gradient-to-b from-white to-pink-50 border border-pink-100">
                <div className="flex items-center gap-3 mb-4">
                  <div className="w-12 h-12 rounded-full bg-gray-200 border-2 border-white shadow-md flex items-center justify-center overflow-hidden">
                    <span className="text-2xl">ğŸƒâ€â™€ï¸</span>
                  </div>
                  <div>
                    <p className="text-xs text-gray-500">Official Ambassador</p>
                    <p className="font-bold text-gray-800">é«˜æ©‹ å°šå­ã•ã‚“</p>
                  </div>
                </div>
                <h3 className="text-xl font-bold text-pink-600 mb-4">{ADVICE_CONTENT[activeTab].title}ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h3>
                <p className="text-gray-700 leading-relaxed text-lg">
                  {ADVICE_CONTENT[activeTab].text}
                </p>
              </Card>
            </div>
          );
        };

        // 4. Shoes Finder (Mini App inside App)
        const ShoeFinder = ({ onBack }) => {
          const [step, setStep] = useState(0);
          const [result, setResult] = useState(null);

          const questions = [
            { q: 'ä»Šã®ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã®ç›®çš„ã¯ï¼Ÿ', options: ['æ¥½ã—ãå®Œèµ°', 'è¨˜éŒ²ã¸ã®æŒ‘æˆ¦', 'å¥åº·ç¶­æŒ'] },
            { q: 'è¶³ã®ç€åœ°æ„Ÿã®å¥½ã¿ã¯ï¼Ÿ', options: ['ãµã‚ãµã‚ï¼ˆã‚¯ãƒƒã‚·ãƒ§ãƒ³ï¼‰', 'åç™ºï¼ˆã‚¹ãƒ”ãƒ¼ãƒ‰ï¼‰', 'å®‰å®šæ„Ÿ'] },
            { q: 'æœˆé–“ã®èµ°è¡Œè·é›¢ã¯ï¼Ÿ', options: ['~50km', '50~100km', '100km~'] },
          ];

          const handleAnswer = () => {
            if (step < 2) {
              setStep(step + 1);
            } else {
              setResult(SHOES_DATA[Math.floor(Math.random() * SHOES_DATA.length)]); // Mock logic
            }
          };

          return (
            <div className="p-4 pb-24 h-full flex flex-col items-center justify-center text-center animate-fade-in">
               {!result ? (
                 <>
                  <h2 className="text-2xl font-bold text-gray-800 mb-8">ã‚ãªãŸã«åˆã†ã‚·ãƒ¥ãƒ¼ã‚ºã¯ï¼Ÿ</h2>
                  <div className="w-full max-w-sm">
                    <p className="text-pink-500 font-bold mb-4">Q{step + 1}. {questions[step].q}</p>
                    <div className="space-y-3">
                      {questions[step].options.map((opt, i) => (
                        <button 
                          key={i} 
                          onClick={handleAnswer}
                          className="w-full p-4 bg-white border border-gray-200 rounded-xl shadow-sm hover:border-pink-500 hover:text-pink-500 transition-all"
                        >
                          {opt}
                        </button>
                      ))}
                    </div>
                    <button onClick={onBack} className="mt-8 text-gray-400 text-sm">ã‚„ã‚ã‚‹</button>
                  </div>
                 </>
               ) : (
                 <div className="animate-fade-in w-full">
                    <h3 className="text-xl font-bold mb-4">ã‚ãªãŸã¸ã®ãŠã™ã™ã‚ï¼</h3>
                    <Card className="p-6 max-w-sm mx-auto">
                      <div className="w-full h-40 bg-gray-100 rounded-lg mb-4 flex items-center justify-center text-4xl">ğŸ‘Ÿ</div>
                      <h4 className="text-xl font-bold text-gray-800">{result.name}</h4>
                      <p className="text-pink-500 font-bold my-2">{result.price}</p>
                      <p className="text-gray-600 text-sm mb-4">{result.desc}</p>
                      <button className="w-full py-3 bg-black text-white rounded-full font-bold">å…¬å¼ã‚¹ãƒˆã‚¢ã§è¦‹ã‚‹</button>
                    </Card>
                    <button onClick={() => {setResult(null); setStep(0);}} className="mt-6 text-pink-500 font-bold">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>
                    <div className="mt-4"><button onClick={onBack} className="text-gray-400">ãƒ›ãƒ¼ãƒ ã¸æˆ»ã‚‹</button></div>
                 </div>
               )}
            </div>
          );
        };

        // 5. Digital Banner (Supporter Mode)
        const CheerBanner = ({ onBack }) => {
          const [text, setText] = useState('GO! NAGOYA!');
          const [isFlashing, setIsFlashing] = useState(false);
          const colors = ['bg-pink-500', 'bg-purple-600', 'bg-blue-500', 'bg-yellow-400'];
          const [colorIdx, setColorIdx] = useState(0);

          useEffect(() => {
            let interval;
            if (isFlashing) {
              interval = setInterval(() => {
                setColorIdx(prev => (prev + 1) % colors.length);
              }, 500);
            }
            return () => clearInterval(interval);
          }, [isFlashing]);

          return (
            <div className={`fixed inset-0 z-50 flex flex-col items-center justify-center transition-colors duration-300 ${isFlashing ? colors[colorIdx] : 'bg-white'}`}>
              <div className="absolute top-4 left-4 z-50">
                <button onClick={onBack} className="p-2 bg-white/20 backdrop-blur-md rounded-full text-black"><X/></button>
              </div>
              
              {!isFlashing ? (
                <div className="p-6 w-full max-w-md space-y-6">
                  <h2 className="text-2xl font-bold text-center">ãƒ‡ã‚¸ã‚¿ãƒ«å¿œæ´å¹•ã‚’ä½œæˆ</h2>
                  <input 
                    type="text" 
                    value={text} 
                    onChange={(e) => setText(e.target.value)}
                    className="w-full p-4 text-2xl font-bold text-center border-2 border-gray-200 rounded-xl focus:border-pink-500 outline-none"
                    placeholder="å¿œæ´ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›"
                  />
                  <div className="grid grid-cols-2 gap-4">
                    <button onClick={() => setIsFlashing(true)} className="p-4 bg-pink-500 text-white rounded-xl font-bold shadow-lg hover:bg-pink-600">
                      å¿œæ´é–‹å§‹ï¼
                    </button>
                  </div>
                  <p className="text-sm text-gray-500 text-center">
                    ã‚¹ãƒãƒ›ã‚’æ¨ªã«ã—ã¦ãƒ©ãƒ³ãƒŠãƒ¼ã«å‘ã‘ã¦æ²ã’ã¦ãã ã•ã„ã€‚<br/>ç”»é¢ãŒç‚¹æ»…ã—ã¦ç›®ç«‹ã¡ã¾ã™ï¼
                  </p>
                </div>
              ) : (
                <div 
                    className="w-full h-full flex items-center justify-center cursor-pointer" 
                    onClick={() => setIsFlashing(false)}
                >
                  <h1 className="text-6xl md:text-8xl font-black text-white rotate-90 md:rotate-0 whitespace-nowrap drop-shadow-lg">
                    {text}
                  </h1>
                  <p className="absolute bottom-10 text-white/50 animate-pulse">ã‚¿ãƒƒãƒ—ã—ã¦åœæ­¢</p>
                </div>
              )}
            </div>
          );
        };

        // 6. Photo Frame (Digital Finisher)
        const PhotoFrame = ({ onBack }) => {
          const [image, setImage] = useState(null);

          const handleUpload = (e) => {
            const file = e.target.files[0];
            if (file) {
              const reader = new FileReader();
              reader.onload = (e) => setImage(e.target.result);
              reader.readAsDataURL(file);
            }
          };

          return (
            <div className="p-4 pb-24 h-full flex flex-col animate-fade-in">
               <div className="flex items-center gap-2 mb-4">
                <button onClick={onBack} className="p-2 bg-gray-100 rounded-full"><ArrowLeft size={20}/></button>
                <h2 className="text-xl font-bold text-gray-800">ãƒ‡ã‚¸ã‚¿ãƒ«å®Œèµ°è¨¼</h2>
              </div>

              {!image ? (
                <div className="flex-grow flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-2xl bg-gray-50 m-4">
                  <Camera size={48} className="text-gray-300 mb-4" />
                  <p className="text-gray-500 mb-6">ã‚´ãƒ¼ãƒ«å¾Œã®å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</p>
                  <label className="bg-pink-500 text-white px-6 py-3 rounded-full font-bold shadow-lg cursor-pointer">
                    å†™çœŸã‚’é¸æŠ
                    <input type="file" className="hidden" accept="image/*" onChange={handleUpload} />
                  </label>
                </div>
              ) : (
                <div className="relative w-full aspect-[3/4] bg-black rounded-xl overflow-hidden shadow-2xl">
                  <img src={image} alt="User" className="w-full h-full object-cover opacity-80" />
                  {/* Frame Overlay */}
                  <div className="absolute inset-0 pointer-events-none border-[10px] border-pink-500/50 flex flex-col justify-between p-6">
                    <div className="text-right">
                       {/* SVG Logo Mock */}
                      <svg viewBox="0 0 100 50" className="h-8 ml-auto brightness-200 fill-white">
                        <path d="M10,40 L30,10 L50,40 M60,10 L60,40 M70,10 C90,10 90,30 70,30 L70,40" stroke="white" strokeWidth="5" fill="none" />
                      </svg>
                    </div>
                    <div>
                      <h2 className="text-3xl font-black text-white italic drop-shadow-md">NAGOYA<br/>WOMEN'S<br/>MARATHON<br/>2026</h2>
                      <div className="mt-2 text-white font-bold text-xl drop-shadow-md">FINISHER 42.195km</div>
                    </div>
                  </div>
                  
                  <div className="absolute bottom-4 right-4 flex gap-2">
                    <button className="bg-white text-black px-4 py-2 rounded-full text-sm font-bold shadow-lg flex items-center gap-2">
                      <Share2 size={16}/> ã‚·ã‚§ã‚¢
                    </button>
                    <button onClick={() => setImage(null)} className="bg-black/50 text-white px-4 py-2 rounded-full text-sm">
                      ã‚„ã‚Šç›´ã™
                    </button>
                  </div>
                </div>
              )}
            </div>
          );
        };

        // --- Main Home View ---

        const HomeView = ({ setView, userMode, stampProgress }) => {
          return (
            <div className="pb-24 space-y-6 animate-fade-in">
              {/* Hero Section */}
              <div className="relative w-full h-56 bg-gray-200 overflow-hidden">
                {/* Placeholder for Main Visual */}
                <div className="absolute inset-0 bg-gradient-to-r from-purple-800 to-pink-600 flex items-center justify-center">
                     <div className="text-center text-white px-4">
                        <p className="text-sm font-bold tracking-widest mb-1 opacity-90">è¦‹ã¤ã‘ã‚ˆã†ã€ã‚ãªãŸã®é“ã‚’ã€‚</p>
                        <h1 className="text-3xl font-black italic drop-shadow-lg leading-tight mb-2">
                          NAGOYA<br/>WOMEN'S MARATHON<br/>2026
                        </h1>
                        <button className="mt-2 bg-white text-pink-600 text-xs font-bold py-1.5 px-4 rounded-full">
                          CHALLENGE ENTRY CAMPAIGN
                        </button>
                     </div>
                </div>
              </div>

              <div className="px-4 -mt-8 relative z-10">
                {/* Countdown */}
                <div className="bg-white/90 backdrop-blur-sm rounded-xl p-4 shadow-lg text-center mb-6 border-b-4 border-pink-400">
                   <p className="text-gray-500 text-xs font-bold mb-1">å¤§ä¼šã¾ã§ã‚ã¨</p>
                   <div className="flex items-baseline justify-center gap-1 text-pink-500">
                     <span className="text-5xl font-black">60</span>
                     <span className="text-lg font-bold">æ—¥</span>
                   </div>
                </div>

                {/* User Mode Specific Content */}
                {userMode === 'runner' ? (
                  <>
                    {/* 3 Main Buttons */}
                    <div className="grid grid-cols-3 gap-3 mb-6">
                      {[
                        { id: 'stamp', icon: Award, label: 'ã‚¹ã‚¿ãƒ³ãƒ—', sub: 'ç‰¹å…¸ã‚ã‚Š', view: 'stamp' },
                        { id: 'course', icon: MapPin, label: 'ã‚³ãƒ¼ã‚¹è§£èª¬', sub: '5ã‚¹ãƒãƒƒãƒˆ', view: 'course' },
                        { id: 'advice', icon: Lightbulb, label: 'ã‚¢ãƒ‰ãƒã‚¤ã‚¹', sub: '4ãƒ†ãƒ¼ãƒ', view: 'advice' }
                      ].map((btn) => (
                        <button 
                          key={btn.id}
                          onClick={() => setView(btn.view)}
                          className="bg-white p-3 rounded-2xl shadow-sm flex flex-col items-center justify-center h-32 hover:bg-gray-50 transition-colors"
                        >
                          <div className="w-12 h-12 bg-indigo-50 rounded-full flex items-center justify-center text-indigo-500 mb-2">
                            <btn.icon size={24} />
                          </div>
                          <span className="font-bold text-sm text-gray-800">{btn.label}</span>
                          <Badge color="bg-indigo-100 text-indigo-600 mt-1 text-[10px]">{btn.sub}</Badge>
                        </button>
                      ))}
                    </div>

                    {/* Stamp Progress Bar */}
                    <div onClick={() => setView('stamp')} className="bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl p-4 text-white mb-8 shadow-md relative overflow-hidden cursor-pointer group">
                      <div className="flex justify-between items-end mb-2 relative z-10">
                        <span className="font-bold text-sm">ã‚¹ã‚¿ãƒ³ãƒ—ãƒ©ãƒªãƒ¼é€²æ—</span>
                        <span className="font-black text-2xl">{stampProgress.length}<span className="text-sm font-normal opacity-70">/3</span></span>
                      </div>
                      <div className="w-full bg-black/20 h-2 rounded-full overflow-hidden relative z-10">
                        <div 
                          className="bg-white h-full rounded-full transition-all duration-1000" 
                          style={{width: `${(stampProgress.length / 3) * 100}%`}}
                        ></div>
                      </div>
                      <p className="text-xs text-right mt-2 opacity-90 relative z-10">3ã¤ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã§ç‰¹å…¸GET!</p>
                      
                      <Award className="absolute -bottom-4 -right-4 text-white/10 w-32 h-32 group-hover:scale-110 transition-transform" />
                    </div>

                    {/* Shoes Section */}
                    <div className="mb-8">
                      <div className="flex justify-between items-center mb-4">
                        <SectionTitle icon={ShoppingBag} title="ãŠã™ã™ã‚ã®ã‚·ãƒ¥ãƒ¼ã‚º" />
                        <button 
                          onClick={() => setView('finder')}
                          className="text-xs text-pink-500 font-bold flex items-center"
                        >
                          è¨ºæ–­ã™ã‚‹ <ChevronRight size={14}/>
                        </button>
                      </div>
                      <div className="grid grid-cols-2 gap-4">
                        {SHOES_DATA.slice(0, 4).map((shoe) => (
                          <div key={shoe.id} className="bg-white p-3 rounded-xl shadow-sm">
                             <div className="aspect-square bg-gray-100 rounded-lg mb-3 flex items-center justify-center text-4xl">ğŸ‘Ÿ</div>
                             <h4 className="font-bold text-sm text-gray-800 leading-tight mb-1">{shoe.name}</h4>
                             <p className="text-xs font-bold text-gray-500">{shoe.price}</p>
                          </div>
                        ))}
                      </div>
                    </div>

                     {/* Finisher Certificate Banner */}
                     <div onClick={() => setView('photo')} className="bg-black rounded-xl p-6 text-white text-center mb-8 relative overflow-hidden cursor-pointer">
                         <div className="relative z-10">
                            <h3 className="font-bold text-lg mb-1">ãƒ‡ã‚¸ã‚¿ãƒ«å®Œèµ°è¨¼</h3>
                            <p className="text-xs text-gray-400">å¤§ä¼šé™å®šãƒ•ãƒ¬ãƒ¼ãƒ ã§æ€ã„å‡ºã‚’æ®‹ãã†</p>
                         </div>
                         <Camera className="absolute top-1/2 left-4 -translate-y-1/2 text-white/20" size={48} />
                         <ChevronRight className="absolute top-1/2 right-4 -translate-y-1/2 text-white" />
                     </div>
                  </>
                ) : (
                  /* SUPPORTER MODE CONTENT */
                  <>
                    <div className="grid grid-cols-2 gap-3 mb-6">
                      <button 
                        onClick={() => setView('banner')}
                        className="bg-pink-500 text-white p-4 rounded-2xl shadow-lg flex flex-col items-center justify-center h-40"
                      >
                        <Smartphone size={40} className="mb-2" />
                        <span className="font-bold text-lg">ãƒ‡ã‚¸ã‚¿ãƒ«å¿œæ´å¹•</span>
                        <span className="text-xs opacity-90 mt-1">ã‚¹ãƒãƒ›ã‚’æ²ã’ã¦å¿œæ´ï¼</span>
                      </button>
                      <button 
                         onClick={() => setView('course')}
                         className="bg-white p-4 rounded-2xl shadow-sm flex flex-col items-center justify-center h-40"
                      >
                        <MapPin size={40} className="text-indigo-500 mb-2" />
                        <span className="font-bold text-lg text-gray-800">å¿œæ´ãƒŠãƒ“</span>
                        <span className="text-xs text-gray-500 mt-1">ãƒ™ã‚¹ãƒˆã‚¹ãƒãƒƒãƒˆã‚’æ¢ã™</span>
                      </button>
                    </div>

                    <Card className="p-4 mb-6">
                      <h3 className="font-bold text-gray-800 mb-2">å¿œæ´ã®ãƒãƒŠãƒ¼</h3>
                      <ul className="text-sm text-gray-600 space-y-2 list-disc pl-4">
                        <li>æ²¿é“ã§ã®å¿œæ´ã¯æŒ‡å®šã®å ´æ‰€ã§è¡Œã„ã¾ã—ã‚‡ã†ã€‚</li>
                        <li>ãƒ©ãƒ³ãƒŠãƒ¼ã®èµ°è¡Œã‚’å¦¨ã’ãªã„ã‚ˆã†ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</li>
                        <li>ãƒ‡ã‚¸ã‚¿ãƒ«å¿œæ´å¹•ãªã‚‰å£°ã‚’å‡ºã•ãšã«æƒ³ã„ã‚’å±Šã‘ã‚‰ã‚Œã¾ã™ã€‚</li>
                      </ul>
                    </Card>
                  </>
                )}

                {/* Shop Section */}
                <div className="mb-8">
                   <SectionTitle icon={MapPin} title="å…¬å¼ã‚·ãƒ§ãƒƒãƒ—" />
                   <div className="bg-gray-900 rounded-xl overflow-hidden shadow-lg text-white">
                      <div className="h-32 bg-gray-800 flex items-center justify-center">

                         <span className="text-gray-600">Store Image</span>
                      </div>
                      <div className="p-4">
                         <h3 className="font-bold mb-1">ãƒ‹ãƒ¥ãƒ¼ãƒãƒ©ãƒ³ã‚¹ åå¤å±‹</h3>
                         <p className="text-xs opacity-70 mb-2 flex items-center gap-1"><MapPin size={12}/> æ„›çŸ¥çœŒåå¤å±‹å¸‚ä¸­åŒºæ „3-3-21 ã‚»ãƒ³ãƒˆãƒ©ã‚¤ã‚ºæ „</p>
                         <p className="text-xs opacity-70 flex items-center gap-1"><Clock size={12}/> 11:00 - 19:00</p>
                      </div>
                   </div>
                </div>

                {/* News Section */}
                <div className="mb-8">
                  <SectionTitle icon={Info} title="æœ€æ–°æƒ…å ±" />
                  <div className="space-y-3">
                    {NEWS_ITEMS.map((news) => (
                      <div key={news.id} className="bg-white p-4 rounded-xl shadow-sm flex gap-4">
                        <div className="w-16 h-16 bg-gray-100 rounded-lg flex-shrink-0"></div>
                        <div>
                           <div className="flex items-center gap-2 mb-1">
                              <Badge color={`${news.color} text-white`}>{news.tag}</Badge>
                              <span className="text-xs text-gray-400">{news.date}</span>
                           </div>
                           <p className="font-bold text-sm text-gray-800 line-clamp-2">{news.title}</p>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>

                {/* Footer Links */}
                <div className="flex justify-center gap-6 text-gray-400 pb-8">
                    <div className="bg-white p-3 rounded-full shadow-sm"><Share2 size={20}/></div>
                    <div className="bg-white p-3 rounded-full shadow-sm"><User size={20}/></div>
                    <div className="bg-white p-3 rounded-full shadow-sm"><Home size={20}/></div>
                </div>
              </div>
            </div>
          );
        };

        // --- Main App Container ---

        function App() {
          // Navigation State
          const [currentView, setCurrentView] = useState('home'); // home, stamp, course, advice, finder, banner, photo
          
          // App Data State
          const [userMode, setUserMode] = useState('runner'); // runner, supporter
          const [stampProgress, setStampProgress] = useState([]);

          // Mock LINE Header
          const Header = () => (
            <div className="bg-white pt-12 pb-3 px-4 flex justify-between items-center sticky top-0 z-40 border-b border-gray-100">
              <div className="flex items-center gap-2">
                 {currentView !== 'home' ? (
                   <span className="font-bold text-gray-800 truncate">åå¤å±‹ã‚¦ã‚£ãƒ¡ãƒ³ã‚ºãƒãƒ©ã‚½ãƒ³</span>
                 ) : (
                   <span className="font-bold text-gray-800 text-lg">LINE Mini App</span>
                 )}
              </div>
              <div className="flex items-center gap-3">
                 {/* Mode Switcher */}
                 {currentView === 'home' && (
                   <button 
                     onClick={() => setUserMode(userMode === 'runner' ? 'supporter' : 'runner')}
                     className={`flex items-center gap-1 px-3 py-1 rounded-full text-xs font-bold transition-all ${
                       userMode === 'runner' 
                         ? 'bg-pink-100 text-pink-600 border border-pink-200' 
                         : 'bg-indigo-100 text-indigo-600 border border-indigo-200'
                     }`}
                   >
                     {userMode === 'runner' ? <><User size={12}/> Runner</> : <><Users size={12}/> Supporter</>}
                   </button>
                 )}
                 <button className="text-gray-400"><X size={24} /></button>
              </div>
            </div>
          );

          // Router Logic
          const renderView = () => {
            switch(currentView) {
              case 'home':
                return <HomeView setView={setCurrentView} userMode={userMode} stampProgress={stampProgress} />;
              case 'stamp':
                return <StampRallyView onBack={() => setCurrentView('home')} progress={stampProgress} setProgress={setStampProgress} />;
              case 'course':
                return <CourseView onBack={() => setCurrentView('home')} />;
              case 'advice':
                return <AdviceView onBack={() => setCurrentView('home')} />;
              case 'finder':
                return <ShoeFinder onBack={() => setCurrentView('home')} />;
              case 'banner':
                return <CheerBanner onBack={() => setCurrentView('home')} />;
              case 'photo':
                return <PhotoFrame onBack={() => setCurrentView('home')} />;
              default:
                return <HomeView setView={setCurrentView} />;
            }
          };

          return (
            <div className="w-full max-w-md mx-auto bg-gray-50 min-h-screen shadow-2xl overflow-hidden font-sans text-gray-900">
              <Header />
              <div className="h-full overflow-y-auto custom-scrollbar">
                {renderView()}
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
    
    <!-- LINE LIFF Init (å¿…é ˆè¦ä»¶2) -->
    <script>
        // LIFFã®åˆæœŸåŒ–ã‚³ãƒ¼ãƒ‰
        if (typeof liff !== 'undefined') {
            liff.init({ liffId: "2008633679-0rjmerKq" })
                .then(() => {
                    console.log("LIFF initialized");
                })
                .catch((err) => {
                    console.log("LIFF initialization failed", err);
                });
        }
    </script>
</body>
</html>
